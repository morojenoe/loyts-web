<div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="30px">
  <mat-form-field appearance="outline">
    <mat-label>Tag search</mat-label>
    <input
      #filterInput
      matInput
      (keyup)="filter(filterInput.value)"
      maxLength="50"
    >
    <mat-hint align="end">{{filterInput.value.length}} / 50</mat-hint>
    <mat-icon matSuffix>search</mat-icon>
  </mat-form-field>

  <mat-divider fxFlexFill></mat-divider>
  
  <div fxLayout="column" fxLayoutGap="5px">
    <ng-container *ngFor="let application of applications$ | async; let i = index">
      <div class="application-container" fxLayout="row">
        <mat-card fxFlex.gt-xs="600px">
          <div fxLayout="column" fxLayoutGap="30px">
            <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="start">
              <div fxFlex="404px" fxFlexAlign="center">
                <app-application
                  id="{{application.id}}"
                  (changePlayer)="changePlayerState(application.id, $event)"
                  [application]="application"
                ></app-application>
              </div>
              <div fxFlex="nogrow">
                <mat-divider fxFlexFill [inset]="true" [vertical]="true"></mat-divider>
              </div>
              <div fxFlex="0 0 66px" fxFlexAlign="center">
                <div
                  fxLayout="row"
                  fxLayoutAlign="center"
                  fxLayoutGap="5px"
                  matTooltip="{{numberOfProposals(application.countProposals)}} people created proposal for this application"
                >
                  <div class="mat-body-2">
                    {{numberOfProposals(application.countProposals)}}
                  </div>
                  <mat-icon>face</mat-icon>
                </div>
              </div>
              <div fxFlex="nogrow">
                <mat-divider fxFlexFill [inset]="true" [vertical]="true"></mat-divider>
              </div>
              <div fxFlex="none" fxFlexAlign="center">
                <button
                  [disabled]="creatingProposalForAppId && creatingProposalForAppId !== application.id"
                  mat-icon-button
                  (click)="initVoiceRecording(application.id)"
                >
                  <mat-icon
                    *ngIf="!creatingProposalForAppId || creatingProposalForAppId !== application.id"
                  >
                    arrow_drop_down
                  </mat-icon>
                  <mat-icon
                    *ngIf="creatingProposalForAppId && creatingProposalForAppId === application.id"
                  >
                    arrow_drop_up
                  </mat-icon>
                </button>
              </div>
            </div>
            <ng-container
              *ngIf="creatingProposalForAppId && creatingProposalForAppId === application.id">
              <mat-divider [inset]="true"></mat-divider>
              <app-record-voice></app-record-voice>
            </ng-container>
          </div>
        </mat-card>
      </div>
    </ng-container>
  </div>

  <div *ngIf="(applications$ | async)?.length === 0"
    fxLayout="row"
    fxLayoutAlign="center center"
    fxLayoutGap="10px"
  >
    <p>
      Nothing found for:
    </p>
    <mat-chip-list>
      <mat-chip>{{filterInput.value}}</mat-chip>
    </mat-chip-list>
  </div>
</div>
